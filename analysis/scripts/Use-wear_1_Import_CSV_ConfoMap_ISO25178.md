Import CSV from ConfoMap ISO25178 - use-wear archaeology
================
Ivan Calandra & Lisa Schunk
2020-09-09 10:19:05

  - [Goal of the script](#goal-of-the-script)
  - [Load packages](#load-packages)
  - [Get names, path and information of all
    files](#get-names-path-and-information-of-all-files)
  - [Read in original CSV-files](#read-in-original-csv-files)
  - [Format data](#format-data)
      - [Merge three datasets](#merge-three-datasets)
      - [Keep only interesting columns and
        rows](#keep-only-interesting-columns-and-rows)
      - [Add headers](#add-headers)
      - [Identify results using frame
        numbers](#identify-results-using-frame-numbers)
      - [Shorten the names for
        parameters](#shorten-the-names-for-parameters)
      - [Save units](#save-units)
      - [Convert to numeric](#convert-to-numeric)
      - [Split the column ‘Name’ into several
        columns](#split-the-column-name-into-several-columns)
      - [Format date and time columns](#format-date-and-time-columns)
      - [Add columns with further information and corrects 50x
        objectives’
        NAs](#add-columns-with-further-information-and-corrects-50x-objectives-nas)
      - [Ignore some columns and reorder
        columns](#ignore-some-columns-and-reorder-columns)
      - [Add units as comment()](#add-units-as-comment)
      - [Check the result](#check-the-result)
  - [Save data](#save-data)
      - [Format name of output file](#format-name-of-output-file)
      - [Write to XLSX](#write-to-xlsx)
      - [Save R object](#save-r-object)
      - [Show files information](#show-files-information)
  - [sessionInfo() and RStudio
    version](#sessioninfo-and-rstudio-version)

-----

# Goal of the script

This script formats the output of the resulting CSV-files from applying
a template computing ISO25178 parameters in ConfoMap. The script will:

1.  Read in the original CSV-files
2.  Format the data  
3.  Write an XLSX-file and save an R object ready for further analysis
    in R

<!-- end list -->

``` r
dir_in <- "analysis/raw_data"
dir_out <- "analysis/derived_data/"
```

Raw data must be located in \~/analysis/raw\_data.  
Formatted data will be saved in \~/analysis/derived\_data/.

The knit directory for this script is the project directory.

-----

# Load packages

``` r
library(openxlsx)
library(tools)
library(R.utils)
library(chron)
library(tidyverse)
```

-----

# Get names, path and information of all files

``` r
data_files <- list.files(dir_in, pattern = "\\.csv$", full.names = TRUE)
md5_in <- md5sum(data_files)
info_in <- data.frame(files = basename(names(md5_in)), checksum = md5_in, 
                      row.names = NULL)
```

The checksum (MD5 hashes) of the imported files are:

``` 
       files                         checksum
1 BA_pro.csv 448e57518fea7cb79b3d07755ae27504
2 BU_pro.csv 1a24067387cfc3860e4531754721964e
3  R_pro.csv 115819f48ed77a49ee02cbb30cb485a2
```

-----

# Read in original CSV-files

``` r
imp_data <- vector(mode = "list", length = length(data_files))
names(imp_data) <- basename(data_files)
# loop for import data due to the three different CSV files 
for (i in seq_along(data_files)) {
  imp_data[[i]] <- read.csv(data_files[i], header = FALSE, 
                            stringsAsFactors = FALSE, na.strings = "*****")
}
str(imp_data)
```

    List of 3
     $ BA_pro.csv:'data.frame': 102 obs. of  100 variables:
      ..$ V1  : chr [1:102] "#" "#" "#" "07.09.2020" ...
      ..$ V2  : chr [1:102] "#" "#" "#" "15:08:03" ...
      ..$ V3  : chr [1:102] "#" "#" "#" "E:\\USE-WEAR\\archaeology\\BALVE\\ConfoMap\\BA_pro --- BA_50x_res --- BA_20x_ext --- MU-232-B2-01-a_20x07_LSM_Topo.mnt" ...
      ..$ V4  : chr [1:102] "OPERATOR:1" "X-axis rotation angle" "°" "-3.126075388" ...
      ..$ V5  : chr [1:102] "OPERATOR:1" "Y-axis rotation angle" "°" "15.76269757" ...
      ..$ V6  : chr [1:102] "OPERATOR:2" "a0" "nm" "27860.91498" ...
      ..$ V7  : chr [1:102] "OPERATOR:2" "ax" "nm" "-140.1050645" ...
      ..$ V8  : chr [1:102] "OPERATOR:2" "ax2" "nm" "0.152743077" ...
      ..$ V9  : chr [1:102] "OPERATOR:2" "ax3" "nm" "-4.27E-05" ...
      ..$ V10 : chr [1:102] "OPERATOR:2" "ay" "nm" "-14.50031072" ...
      ..$ V11 : chr [1:102] "OPERATOR:2" "axy" "nm" "0.070278252" ...
      ..$ V12 : chr [1:102] "OPERATOR:2" "ax2y" "nm" "-6.42E-05" ...
      ..$ V13 : chr [1:102] "OPERATOR:2" "ay2" "nm" "0.006875652" ...
      ..$ V14 : chr [1:102] "OPERATOR:2" "axy2" "nm" "3.42E-05" ...
      ..$ V15 : chr [1:102] "OPERATOR:2" "ay3" "nm" "-2.29E-05" ...
      ..$ V16 : chr [1:102] "6" "Name" "<no unit>" "BA_50x_res --- BA_20x_ext --- MU-232_B2-01-a_20x07_LSM_Topo" ...
      ..$ V17 : chr [1:102] "6" "Created on" "<no unit>" "07.07.2020 16:58" ...
      ..$ V18 : chr [1:102] "6" "Studiable type" "<no unit>" "Surface" ...
      ..$ V19 : chr [1:102] "6" "Axis name - X" "<no unit>" "X" ...
      ..$ V20 : chr [1:102] "6" "Axis length - X" "µm" "254.9211018" ...
      ..$ V21 : chr [1:102] "6" "Axis size - X" "points" "1198" ...
      ..$ V22 : chr [1:102] "6" "Axis spacing - X" "µm" "0.212966668" ...
      ..$ V23 : chr [1:102] "6" "Axis name - Y" "<no unit>" "Y" ...
      ..$ V24 : chr [1:102] "6" "Axis length - Y" "µm" "254.9211018" ...
      ..$ V25 : chr [1:102] "6" "Axis size - Y" "points" "1198" ...
      ..$ V26 : chr [1:102] "6" "Axis spacing - Y" "µm" "0.212966668" ...
      ..$ V27 : chr [1:102] "6" "Axis name - Z" "<no unit>" "Z" ...
      ..$ V28 : chr [1:102] "6" "Layer type - Z" "<no unit>" "Topography" ...
      ..$ V29 : chr [1:102] "6" "Axis length - Z" "nm" "249563.8891" ...
      ..$ V30 : chr [1:102] "6" "Axis size - Z" "digits" "65505" ...
      ..$ V31 : chr [1:102] "6" "Axis spacing - Z" "nm" "3.809844884" ...
      ..$ V32 : chr [1:102] "6" "NM-points ratio - Z" "%" "0" ...
      ..$ V33 : chr [1:102] "8" "Name" "<no unit>" "BA_50x_res --- BA_20x_ext --- MU-232-B2-01-a_20x07_LSM_Topo > Leveled (LS-plane)" ...
      ..$ V34 : chr [1:102] "8" "Created on" "<no unit>" "07.07.2020 16:58" ...
      ..$ V35 : chr [1:102] "8" "Studiable type" "<no unit>" "Surface" ...
      ..$ V36 : chr [1:102] "8" "Axis name - X" "<no unit>" "X" ...
      ..$ V37 : chr [1:102] "8" "Axis length - X" "µm" "254.9211018" ...
      ..$ V38 : chr [1:102] "8" "Axis size - X" "points" "1198" ...
      ..$ V39 : chr [1:102] "8" "Axis spacing - X" "µm" "0.212966668" ...
      ..$ V40 : chr [1:102] "8" "Axis name - Y" "<no unit>" "Y" ...
      ..$ V41 : chr [1:102] "8" "Axis length - Y" "µm" "254.9211018" ...
      ..$ V42 : chr [1:102] "8" "Axis size - Y" "points" "1198" ...
      ..$ V43 : chr [1:102] "8" "Axis spacing - Y" "µm" "0.212966668" ...
      ..$ V44 : chr [1:102] "8" "Axis name - Z" "<no unit>" "Z" ...
      ..$ V45 : chr [1:102] "8" "Layer type - Z" "<no unit>" "Topography" ...
      ..$ V46 : chr [1:102] "8" "Axis length - Z" "nm" "270491.3671" ...
      ..$ V47 : chr [1:102] "8" "Axis size - Z" "digits" "70998" ...
      ..$ V48 : chr [1:102] "8" "Axis spacing - Z" "nm" "3.809844884" ...
      ..$ V49 : chr [1:102] "8" "NM-points ratio - Z" "%" "0" ...
      ..$ V50 : chr [1:102] "15" "Name" "<no unit>" "BA_50x_res --- BA_20x_ext --- MU-232-B2-01-a_20x07_LSM_Topo > Leveled (LS-plane) > Form removed (LS-poly 3) > O"| __truncated__ ...
      ..$ V51 : chr [1:102] "15" "Created on" "<no unit>" "07.07.2020 16:58" ...
      ..$ V52 : chr [1:102] "15" "Studiable type" "<no unit>" "Surface" ...
      ..$ V53 : chr [1:102] "15" "Axis name - X" "<no unit>" "X" ...
      ..$ V54 : chr [1:102] "15" "Axis length - X" "µm" "254.9211018" ...
      ..$ V55 : chr [1:102] "15" "Axis size - X" "points" "1198" ...
      ..$ V56 : chr [1:102] "15" "Axis spacing - X" "µm" "0.212966668" ...
      ..$ V57 : chr [1:102] "15" "Axis name - Y" "<no unit>" "Y" ...
      ..$ V58 : chr [1:102] "15" "Axis length - Y" "µm" "254.9211018" ...
      ..$ V59 : chr [1:102] "15" "Axis size - Y" "points" "1198" ...
      ..$ V60 : chr [1:102] "15" "Axis spacing - Y" "µm" "0.212966668" ...
      ..$ V61 : chr [1:102] "15" "Axis name - Z" "<no unit>" "Z" ...
      ..$ V62 : chr [1:102] "15" "Layer type - Z" "<no unit>" "Topography" ...
      ..$ V63 : chr [1:102] "15" "Axis length - Z" "nm" "20482.48807" ...
      ..$ V64 : chr [1:102] "15" "Axis size - Z" "digits" "53762" ...
      ..$ V65 : chr [1:102] "15" "Axis spacing - Z" "nm" "0.380984488" ...
      ..$ V66 : chr [1:102] "15" "NM-points ratio - Z" "%" "0" ...
      ..$ V67 : chr [1:102] "17" "Sq" "nm" "3243.46492" ...
      ..$ V68 : chr [1:102] "17" "Ssk" "<no unit>" "0.063364928" ...
      ..$ V69 : chr [1:102] "17" "Sku" "<no unit>" "3.456648954" ...
      ..$ V70 : chr [1:102] "17" "Sp" "nm" "10477.07343" ...
      ..$ V71 : chr [1:102] "17" "Sv" "nm" "10005.41463" ...
      ..$ V72 : chr [1:102] "17" "Sz" "nm" "20482.48807" ...
      ..$ V73 : chr [1:102] "17" "Sa" "nm" "2505.545764" ...
      ..$ V74 : chr [1:102] "17" "Smr (c = 1000 nm below highest peak)" "%" "0.551009273" ...
      ..$ V75 : chr [1:102] "17" "Smc (p = 10.00%)" "nm" "3753.565649" ...
      ..$ V76 : chr [1:102] "17" "Sxp (p = 50.00%  q = 97.50%)" "nm" "6582.264251" ...
      ..$ V77 : chr [1:102] "17" "Sal (s = 0.2000)" "µm" "25.94647646" ...
      ..$ V78 : chr [1:102] "17" "Str (s = 0.2000)" "<no unit>" "0.321132254" ...
      ..$ V79 : chr [1:102] "17" "Std (Reference angle = 0.000°)" "°" "42.49526812" ...
      ..$ V80 : chr [1:102] "17" "Sdq" "<no unit>" "0.602524437" ...
      ..$ V81 : chr [1:102] "17" "Sdr" "%" "9.99401306" ...
      ..$ V82 : chr [1:102] "17" "Vm (p = 10.00%)" "µm³/µm²" "0.209379149" ...
      ..$ V83 : chr [1:102] "17" "Vv (p = 10.00%)" "µm³/µm²" "3.962846805" ...
      ..$ V84 : chr [1:102] "17" "Vmp (p = 10.00%)" "µm³/µm²" "0.209379149" ...
      ..$ V85 : chr [1:102] "17" "Vmc (p = 10.00%  q = 80.00%)" "µm³/µm²" "2.775219749" ...
      ..$ V86 : chr [1:102] "17" "Vvc (p = 10.00%  q = 80.00%)" "µm³/µm²" "3.55940934" ...
      ..$ V87 : chr [1:102] "17" "Vvv (p = 80.00%)" "µm³/µm²" "0.403437465" ...
      ..$ V88 : chr [1:102] "18" "Maximum depth of furrows" "nm" "12698.49874" ...
      ..$ V89 : chr [1:102] "18" "Mean depth of furrows" "nm" "2585.970205" ...
      ..$ V90 : chr [1:102] "18" "Mean density of furrows" "cm/cm2" "2987.422098" ...
      ..$ V91 : chr [1:102] "19" "First direction" "°" "44.9809005" ...
      ..$ V92 : chr [1:102] "19" "Second direction" "°" "26.45485129" ...
      ..$ V93 : chr [1:102] "19" "Third direction" "°" "63.52628654" ...
      ..$ V94 : chr [1:102] "20" "Isotropy" "%" "13.49804216" ...
      ..$ V95 : chr [1:102] "21" "Length-scale anisotropy (Sfrax) (epLsar)" "<no unit>" "0.003682853" ...
      ..$ V96 : chr [1:102] "21" "Length-scale anisotropy (NewEplsar)" "<no unit>" "0.018102172" ...
      ..$ V97 : chr [1:102] "22" "Fractal complexity (Asfc)" "<no unit>" "12.79944237" ...
      ..$ V98 : chr [1:102] "22" "Scale of max complexity (Smfc)" "µm²" "2.508392949" ...
      ..$ V99 : chr [1:102] "22" "HAsfc9 (HAsfc9)" "<no unit>" "0.629247569" ...
      .. [list output truncated]
     $ BU_pro.csv:'data.frame': 21 obs. of  100 variables:
      ..$ V1  : chr [1:21] "#" "#" "#" "07.09.2020" ...
      ..$ V2  : chr [1:21] "#" "#" "#" "14:54:55" ...
      ..$ V3  : chr [1:21] "#" "#" "#" "E:\\USE-WEAR\\archaeology\\BUHLEN\\ConfoMap\\BU_pro --- BU_50x_res ---  -  -  - Users - schunk - Documents - US"| __truncated__ ...
      ..$ V4  : chr [1:21] "OPERATOR:1" "X-axis rotation angle" "°" "-2.694053682" ...
      ..$ V5  : chr [1:21] "OPERATOR:1" "Y-axis rotation angle" "°" "-4.169364046" ...
      ..$ V6  : chr [1:21] "OPERATOR:2" "a0" "nm" "-5316.302467" ...
      ..$ V7  : chr [1:21] "OPERATOR:2" "ax" "nm" "20.87003088" ...
      ..$ V8  : chr [1:21] "OPERATOR:2" "ax2" "nm" "-0.023343306" ...
      ..$ V9  : chr [1:21] "OPERATOR:2" "ax3" "nm" "7.67E-06" ...
      ..$ V10 : chr [1:21] "OPERATOR:2" "ay" "nm" "6.260864436" ...
      ..$ V11 : chr [1:21] "OPERATOR:2" "axy" "nm" "0.003825339" ...
      ..$ V12 : chr [1:21] "OPERATOR:2" "ax2y" "nm" "-9.87E-06" ...
      ..$ V13 : chr [1:21] "OPERATOR:2" "ay2" "nm" "-0.006613336" ...
      ..$ V14 : chr [1:21] "OPERATOR:2" "axy2" "nm" "4.10E-06" ...
      ..$ V15 : chr [1:21] "OPERATOR:2" "ay3" "nm" "8.83E-07" ...
      ..$ V16 : chr [1:21] "6" "Name" "<no unit>" "BU_50x_res ---  -  -  - Users - schunk - Documents - USE-WEAR - BUHLEN - LSM - BU-003 - BU-003_C1-01-a_50x09_LSM_Topo" ...
      ..$ V17 : chr [1:21] "6" "Created on" "<no unit>" "07.02.2020 10:45" ...
      ..$ V18 : chr [1:21] "6" "Studiable type" "<no unit>" "Surface" ...
      ..$ V19 : chr [1:21] "6" "Axis name - X" "<no unit>" "X" ...
      ..$ V20 : chr [1:21] "6" "Axis length - X" "µm" "255.4748056" ...
      ..$ V21 : chr [1:21] "6" "Axis size - X" "points" "1198" ...
      ..$ V22 : chr [1:21] "6" "Axis spacing - X" "µm" "0.213429245" ...
      ..$ V23 : chr [1:21] "6" "Axis name - Y" "<no unit>" "Y" ...
      ..$ V24 : chr [1:21] "6" "Axis length - Y" "µm" "255.4748056" ...
      ..$ V25 : chr [1:21] "6" "Axis size - Y" "points" "1198" ...
      ..$ V26 : chr [1:21] "6" "Axis spacing - Y" "µm" "0.213429245" ...
      ..$ V27 : chr [1:21] "6" "Axis name - Z" "<no unit>" "Z" ...
      ..$ V28 : chr [1:21] "6" "Layer type - Z" "<no unit>" "Topography" ...
      ..$ V29 : chr [1:21] "6" "Axis length - Z" "nm" "38041.42788" ...
      ..$ V30 : chr [1:21] "6" "Axis size - Z" "digits" "64277" ...
      ..$ V31 : chr [1:21] "6" "Axis spacing - Z" "nm" "0.591835772" ...
      ..$ V32 : chr [1:21] "6" "NM-points ratio - Z" "%" "0" ...
      ..$ V33 : chr [1:21] "8" "Name" "<no unit>" "BU_50x_res ---  -  -  - Users - schunk - Documents - USE-WEAR - BUHLEN - LSM - BU-003 - BU-003-C1-01-a_50x09_LS"| __truncated__ ...
      ..$ V34 : chr [1:21] "8" "Created on" "<no unit>" "07.02.2020 10:45" ...
      ..$ V35 : chr [1:21] "8" "Studiable type" "<no unit>" "Surface" ...
      ..$ V36 : chr [1:21] "8" "Axis name - X" "<no unit>" "X" ...
      ..$ V37 : chr [1:21] "8" "Axis length - X" "µm" "255.4748056" ...
      ..$ V38 : chr [1:21] "8" "Axis size - X" "points" "1198" ...
      ..$ V39 : chr [1:21] "8" "Axis spacing - X" "µm" "0.213429245" ...
      ..$ V40 : chr [1:21] "8" "Axis name - Y" "<no unit>" "Y" ...
      ..$ V41 : chr [1:21] "8" "Axis length - Y" "µm" "255.4748056" ...
      ..$ V42 : chr [1:21] "8" "Axis size - Y" "points" "1198" ...
      ..$ V43 : chr [1:21] "8" "Axis spacing - Y" "µm" "0.213429245" ...
      ..$ V44 : chr [1:21] "8" "Axis name - Z" "<no unit>" "Z" ...
      ..$ V45 : chr [1:21] "8" "Layer type - Z" "<no unit>" "Topography" ...
      ..$ V46 : chr [1:21] "8" "Axis length - Z" "nm" "18938.74469" ...
      ..$ V47 : chr [1:21] "8" "Axis size - Z" "digits" "32000" ...
      ..$ V48 : chr [1:21] "8" "Axis spacing - Z" "nm" "0.591835772" ...
      ..$ V49 : chr [1:21] "8" "NM-points ratio - Z" "%" "0" ...
      ..$ V50 : chr [1:21] "15" "Name" "<no unit>" "BU_50x_res ---  -  -  - Users - schunk - Documents - USE-WEAR - BUHLEN - LSM - BU-003 - BU-003-C1-01-a_50x09_LS"| __truncated__ ...
      ..$ V51 : chr [1:21] "15" "Created on" "<no unit>" "07.02.2020 10:45" ...
      ..$ V52 : chr [1:21] "15" "Studiable type" "<no unit>" "Surface" ...
      ..$ V53 : chr [1:21] "15" "Axis name - X" "<no unit>" "X" ...
      ..$ V54 : chr [1:21] "15" "Axis length - X" "µm" "255.4748056" ...
      ..$ V55 : chr [1:21] "15" "Axis size - X" "points" "1198" ...
      ..$ V56 : chr [1:21] "15" "Axis spacing - X" "µm" "0.213429245" ...
      ..$ V57 : chr [1:21] "15" "Axis name - Y" "<no unit>" "Y" ...
      ..$ V58 : chr [1:21] "15" "Axis length - Y" "µm" "255.4748056" ...
      ..$ V59 : chr [1:21] "15" "Axis size - Y" "points" "1198" ...
      ..$ V60 : chr [1:21] "15" "Axis spacing - Y" "µm" "0.213429245" ...
      ..$ V61 : chr [1:21] "15" "Axis name - Z" "<no unit>" "Z" ...
      ..$ V62 : chr [1:21] "15" "Layer type - Z" "<no unit>" "Topography" ...
      ..$ V63 : chr [1:21] "15" "Axis length - Z" "nm" "8682.585869" ...
      ..$ V64 : chr [1:21] "15" "Axis size - Z" "digits" "146706" ...
      ..$ V65 : chr [1:21] "15" "Axis spacing - Z" "nm" "0.059183577" ...
      ..$ V66 : chr [1:21] "15" "NM-points ratio - Z" "%" "0" ...
      ..$ V67 : chr [1:21] "17" "Sq" "nm" "1048.895159" ...
      ..$ V68 : chr [1:21] "17" "Ssk" "<no unit>" "0.132560228" ...
      ..$ V69 : chr [1:21] "17" "Sku" "<no unit>" "3.516410324" ...
      ..$ V70 : chr [1:21] "17" "Sp" "nm" "5140.389593" ...
      ..$ V71 : chr [1:21] "17" "Sv" "nm" "3542.196276" ...
      ..$ V72 : chr [1:21] "17" "Sz" "nm" "8682.585869" ...
      ..$ V73 : chr [1:21] "17" "Sa" "nm" "814.220228" ...
      ..$ V74 : chr [1:21] "17" "Smr (c = 1000 nm below highest peak)" "%" "0.085139289" ...
      ..$ V75 : chr [1:21] "17" "Smc (p = 10.00%)" "nm" "1348.441983" ...
      ..$ V76 : chr [1:21] "17" "Sxp (p = 50.00%  q = 97.50%)" "nm" "1988.48162" ...
      ..$ V77 : chr [1:21] "17" "Sal (s = 0.2000)" "µm" "28.35891284" ...
      ..$ V78 : chr [1:21] "17" "Str (s = 0.2000)" "<no unit>" "0.360722274" ...
      ..$ V79 : chr [1:21] "17" "Std (Reference angle = 0.000°)" "°" "140.7494502" ...
      ..$ V80 : chr [1:21] "17" "Sdq" "<no unit>" "0.222325802" ...
      ..$ V81 : chr [1:21] "17" "Sdr" "%" "2.287042675" ...
      ..$ V82 : chr [1:21] "17" "Vm (p = 10.00%)" "µm³/µm²" "0.057522401" ...
      ..$ V83 : chr [1:21] "17" "Vv (p = 10.00%)" "µm³/µm²" "1.405952937" ...
      ..$ V84 : chr [1:21] "17" "Vmp (p = 10.00%)" "µm³/µm²" "0.057522401" ...
      ..$ V85 : chr [1:21] "17" "Vmc (p = 10.00%  q = 80.00%)" "µm³/µm²" "0.893352314" ...
      ..$ V86 : chr [1:21] "17" "Vvc (p = 10.00%  q = 80.00%)" "µm³/µm²" "1.286082915" ...
      ..$ V87 : chr [1:21] "17" "Vvv (p = 80.00%)" "µm³/µm²" "0.119870022" ...
      ..$ V88 : chr [1:21] "18" "Maximum depth of furrows" "nm" "3486.622897" ...
      ..$ V89 : chr [1:21] "18" "Mean depth of furrows" "nm" "899.2230935" ...
      ..$ V90 : chr [1:21] "18" "Mean density of furrows" "cm/cm2" "2578.372416" ...
      ..$ V91 : chr [1:21] "19" "First direction" "°" "135.0094627" ...
      ..$ V92 : chr [1:21] "19" "Second direction" "°" "90.00677511" ...
      ..$ V93 : chr [1:21] "19" "Third direction" "°" "153.5489476" ...
      ..$ V94 : chr [1:21] "20" "Isotropy" "%" "75.30256987" ...
      ..$ V95 : chr [1:21] "21" "Length-scale anisotropy (Sfrax) (epLsar)" "<no unit>" "0.00164011" ...
      ..$ V96 : chr [1:21] "21" "Length-scale anisotropy (NewEplsar)" "<no unit>" "0.018376251" ...
      ..$ V97 : chr [1:21] "22" "Fractal complexity (Asfc)" "<no unit>" "3.698324762" ...
      ..$ V98 : chr [1:21] "22" "Scale of max complexity (Smfc)" "µm²" "4.610763815" ...
      ..$ V99 : chr [1:21] "22" "HAsfc9 (HAsfc9)" "<no unit>" "0.148106526" ...
      .. [list output truncated]
     $ R_pro.csv :'data.frame': 36 obs. of  100 variables:
      ..$ V1  : chr [1:36] "#" "#" "#" "07.09.2020" ...
      ..$ V2  : chr [1:36] "#" "#" "#" "14:31:36" ...
      ..$ V3  : chr [1:36] "#" "#" "#" "E:\\USE-WEAR\\archaeology\\RAMIOUL\\ConfoMap\\R_pro --- R_50x_res ---  -  - Users - schunk - Documents - USE-WE"| __truncated__ ...
      ..$ V4  : chr [1:36] "OPERATOR:1" "X-axis rotation angle" "°" "0.694920518" ...
      ..$ V5  : chr [1:36] "OPERATOR:1" "Y-axis rotation angle" "°" "2.627071571" ...
      ..$ V6  : chr [1:36] "OPERATOR:2" "a0" "nm" "1672.074411" ...
      ..$ V7  : chr [1:36] "OPERATOR:2" "ax" "nm" "-3.802595656" ...
      ..$ V8  : chr [1:36] "OPERATOR:2" "ax2" "nm" "0.010569345" ...
      ..$ V9  : chr [1:36] "OPERATOR:2" "ax3" "nm" "-9.36E-06" ...
      ..$ V10 : chr [1:36] "OPERATOR:2" "ay" "nm" "-7.303528796" ...
      ..$ V11 : chr [1:36] "OPERATOR:2" "axy" "nm" "0.004108866" ...
      ..$ V12 : chr [1:36] "OPERATOR:2" "ax2y" "nm" "3.14E-06" ...
      ..$ V13 : chr [1:36] "OPERATOR:2" "ay2" "nm" "0.00761333" ...
      ..$ V14 : chr [1:36] "OPERATOR:2" "axy2" "nm" "-3.12E-06" ...
      ..$ V15 : chr [1:36] "OPERATOR:2" "ay3" "nm" "-2.74E-06" ...
      ..$ V16 : chr [1:36] "6" "Name" "<no unit>" "R_50x_res ---  -  - Users - schunk - Documents - USE-WEAR - RAMIOUL - LSM - R-002 - R-002_A1-01-a_50x09_LSM_Topo" ...
      ..$ V17 : chr [1:36] "6" "Created on" "<no unit>" "07.01.2020 09:56" ...
      ..$ V18 : chr [1:36] "6" "Studiable type" "<no unit>" "Surface" ...
      ..$ V19 : chr [1:36] "6" "Axis name - X" "<no unit>" "X" ...
      ..$ V20 : chr [1:36] "6" "Axis length - X" "µm" "255.4748056" ...
      ..$ V21 : chr [1:36] "6" "Axis size - X" "points" "1198" ...
      ..$ V22 : chr [1:36] "6" "Axis spacing - X" "µm" "0.213429245" ...
      ..$ V23 : chr [1:36] "6" "Axis name - Y" "<no unit>" "Y" ...
      ..$ V24 : chr [1:36] "6" "Axis length - Y" "µm" "255.4748056" ...
      ..$ V25 : chr [1:36] "6" "Axis size - Y" "points" "1198" ...
      ..$ V26 : chr [1:36] "6" "Axis spacing - Y" "µm" "0.213429245" ...
      ..$ V27 : chr [1:36] "6" "Axis name - Z" "<no unit>" "Z" ...
      ..$ V28 : chr [1:36] "6" "Layer type - Z" "<no unit>" "Topography" ...
      ..$ V29 : chr [1:36] "6" "Axis length - Z" "nm" "20213.11055" ...
      ..$ V30 : chr [1:36] "6" "Axis size - Z" "digits" "66293" ...
      ..$ V31 : chr [1:36] "6" "Axis spacing - Z" "nm" "0.304905655" ...
      ..$ V32 : chr [1:36] "6" "NM-points ratio - Z" "%" "0" ...
      ..$ V33 : chr [1:36] "8" "Name" "<no unit>" "R_50x_res ---  -  - Users - schunk - Documents - USE-WEAR - RAMIOUL - LSM - R-002 - R-002_A1-01-a_50x09_LSM_Top"| __truncated__ ...
      ..$ V34 : chr [1:36] "8" "Created on" "<no unit>" "07.01.2020 09:56" ...
      ..$ V35 : chr [1:36] "8" "Studiable type" "<no unit>" "Surface" ...
      ..$ V36 : chr [1:36] "8" "Axis name - X" "<no unit>" "X" ...
      ..$ V37 : chr [1:36] "8" "Axis length - X" "µm" "255.4748056" ...
      ..$ V38 : chr [1:36] "8" "Axis size - X" "points" "1198" ...
      ..$ V39 : chr [1:36] "8" "Axis spacing - X" "µm" "0.213429245" ...
      ..$ V40 : chr [1:36] "8" "Axis name - Y" "<no unit>" "Y" ...
      ..$ V41 : chr [1:36] "8" "Axis length - Y" "µm" "255.4748056" ...
      ..$ V42 : chr [1:36] "8" "Axis size - Y" "points" "1198" ...
      ..$ V43 : chr [1:36] "8" "Axis spacing - Y" "µm" "0.213429245" ...
      ..$ V44 : chr [1:36] "8" "Axis name - Z" "<no unit>" "Z" ...
      ..$ V45 : chr [1:36] "8" "Layer type - Z" "<no unit>" "Topography" ...
      ..$ V46 : chr [1:36] "8" "Axis length - Z" "nm" "10441.79904" ...
      ..$ V47 : chr [1:36] "8" "Axis size - Z" "digits" "34246" ...
      ..$ V48 : chr [1:36] "8" "Axis spacing - Z" "nm" "0.304905655" ...
      ..$ V49 : chr [1:36] "8" "NM-points ratio - Z" "%" "0" ...
      ..$ V50 : chr [1:36] "15" "Name" "<no unit>" "R_50x_res ---  -  - Users - schunk - Documents - USE-WEAR - RAMIOUL - LSM - R-002 - R-002_A1-01-a_50x09_LSM_Top"| __truncated__ ...
      ..$ V51 : chr [1:36] "15" "Created on" "<no unit>" "07.01.2020 09:56" ...
      ..$ V52 : chr [1:36] "15" "Studiable type" "<no unit>" "Surface" ...
      ..$ V53 : chr [1:36] "15" "Axis name - X" "<no unit>" "X" ...
      ..$ V54 : chr [1:36] "15" "Axis length - X" "µm" "255.4748056" ...
      ..$ V55 : chr [1:36] "15" "Axis size - X" "points" "1198" ...
      ..$ V56 : chr [1:36] "15" "Axis spacing - X" "µm" "0.213429245" ...
      ..$ V57 : chr [1:36] "15" "Axis name - Y" "<no unit>" "Y" ...
      ..$ V58 : chr [1:36] "15" "Axis length - Y" "µm" "255.4748056" ...
      ..$ V59 : chr [1:36] "15" "Axis size - Y" "points" "1198" ...
      ..$ V60 : chr [1:36] "15" "Axis spacing - Y" "µm" "0.213429245" ...
      ..$ V61 : chr [1:36] "15" "Axis name - Z" "<no unit>" "Z" ...
      ..$ V62 : chr [1:36] "15" "Layer type - Z" "<no unit>" "Topography" ...
      ..$ V63 : chr [1:36] "15" "Axis length - Z" "nm" "6777.412398" ...
      ..$ V64 : chr [1:36] "15" "Axis size - Z" "digits" "222279" ...
      ..$ V65 : chr [1:36] "15" "Axis spacing - Z" "nm" "0.030490565" ...
      ..$ V66 : chr [1:36] "15" "NM-points ratio - Z" "%" "0" ...
      ..$ V67 : chr [1:36] "17" "Sq" "nm" "965.6698832" ...
      ..$ V68 : chr [1:36] "17" "Ssk" "<no unit>" "0.223698651" ...
      ..$ V69 : chr [1:36] "17" "Sku" "<no unit>" "3.305367398" ...
      ..$ V70 : chr [1:36] "17" "Sp" "nm" "2982.770056" ...
      ..$ V71 : chr [1:36] "17" "Sv" "nm" "3794.642342" ...
      ..$ V72 : chr [1:36] "17" "Sz" "nm" "6777.412398" ...
      ..$ V73 : chr [1:36] "17" "Sa" "nm" "753.1662694" ...
      ..$ V74 : chr [1:36] "17" "Smr (c = 1000 nm below highest peak)" "%" "3.36939136" ...
      ..$ V75 : chr [1:36] "17" "Smc (p = 10.00%)" "nm" "1286.370713" ...
      ..$ V76 : chr [1:36] "17" "Sxp (p = 50.00%  q = 97.50%)" "nm" "1714.056906" ...
      ..$ V77 : chr [1:36] "17" "Sal (s = 0.2000)" "µm" "20.8354156" ...
      ..$ V78 : chr [1:36] "17" "Str (s = 0.2000)" "<no unit>" "0.286866253" ...
      ..$ V79 : chr [1:36] "17" "Std (Reference angle = 0.000°)" "°" "98.49823473" ...
      ..$ V80 : chr [1:36] "17" "Sdq" "<no unit>" "0.18024731" ...
      ..$ V81 : chr [1:36] "17" "Sdr" "%" "1.545220979" ...
      ..$ V82 : chr [1:36] "17" "Vm (p = 10.00%)" "µm³/µm²" "0.056528148" ...
      ..$ V83 : chr [1:36] "17" "Vv (p = 10.00%)" "µm³/µm²" "1.342889309" ...
      ..$ V84 : chr [1:36] "17" "Vmp (p = 10.00%)" "µm³/µm²" "0.056528148" ...
      ..$ V85 : chr [1:36] "17" "Vmc (p = 10.00%  q = 80.00%)" "µm³/µm²" "0.838905952" ...
      ..$ V86 : chr [1:36] "17" "Vvc (p = 10.00%  q = 80.00%)" "µm³/µm²" "1.242258083" ...
      ..$ V87 : chr [1:36] "17" "Vvv (p = 80.00%)" "µm³/µm²" "0.100631226" ...
      ..$ V88 : chr [1:36] "18" "Maximum depth of furrows" "nm" "4680.149344" ...
      ..$ V89 : chr [1:36] "18" "Mean depth of furrows" "nm" "1003.094218" ...
      ..$ V90 : chr [1:36] "18" "Mean density of furrows" "cm/cm2" "2236.279395" ...
      ..$ V91 : chr [1:36] "19" "First direction" "°" "135.014308" ...
      ..$ V92 : chr [1:36] "19" "Second direction" "°" "90.00996958" ...
      ..$ V93 : chr [1:36] "19" "Third direction" "°" "153.4974777" ...
      ..$ V94 : chr [1:36] "20" "Isotropy" "%" "53.47867338" ...
      ..$ V95 : chr [1:36] "21" "Length-scale anisotropy (Sfrax) (epLsar)" "<no unit>" "0.003935162" ...
      ..$ V96 : chr [1:36] "21" "Length-scale anisotropy (NewEplsar)" "<no unit>" "0.018107507" ...
      ..$ V97 : chr [1:36] "22" "Fractal complexity (Asfc)" "<no unit>" "2.288328872" ...
      ..$ V98 : chr [1:36] "22" "Scale of max complexity (Smfc)" "µm²" "9.024672658" ...
      ..$ V99 : chr [1:36] "22" "HAsfc9 (HAsfc9)" "<no unit>" "0.215684673" ...
      .. [list output truncated]

-----

# Format data

## Merge three datasets

``` r
# check pairwisely if the three lines of headers are identical among the datasets
# merges the data based on the three lines of headers while they get only 
# used in the first CSV file 
comp <- all(sapply(list(imp_data[[1]][1:3, ], imp_data[[2]][1:3, ]), 
                   FUN = identical, imp_data[[3]][1:3, ]))
if (comp == TRUE) {
  merged_data <- rbind(imp_data[[1]], imp_data[[2]][-(1:3), ], 
                       imp_data[[3]][-(1:3), ])
} else {
  stop("The headers are not identical among the datasets")
}
str(merged_data)
```

    'data.frame':   153 obs. of  100 variables:
     $ V1  : chr  "#" "#" "#" "07.09.2020" ...
     $ V2  : chr  "#" "#" "#" "15:08:03" ...
     $ V3  : chr  "#" "#" "#" "E:\\USE-WEAR\\archaeology\\BALVE\\ConfoMap\\BA_pro --- BA_50x_res --- BA_20x_ext --- MU-232-B2-01-a_20x07_LSM_Topo.mnt" ...
     $ V4  : chr  "OPERATOR:1" "X-axis rotation angle" "°" "-3.126075388" ...
     $ V5  : chr  "OPERATOR:1" "Y-axis rotation angle" "°" "15.76269757" ...
     $ V6  : chr  "OPERATOR:2" "a0" "nm" "27860.91498" ...
     $ V7  : chr  "OPERATOR:2" "ax" "nm" "-140.1050645" ...
     $ V8  : chr  "OPERATOR:2" "ax2" "nm" "0.152743077" ...
     $ V9  : chr  "OPERATOR:2" "ax3" "nm" "-4.27E-05" ...
     $ V10 : chr  "OPERATOR:2" "ay" "nm" "-14.50031072" ...
     $ V11 : chr  "OPERATOR:2" "axy" "nm" "0.070278252" ...
     $ V12 : chr  "OPERATOR:2" "ax2y" "nm" "-6.42E-05" ...
     $ V13 : chr  "OPERATOR:2" "ay2" "nm" "0.006875652" ...
     $ V14 : chr  "OPERATOR:2" "axy2" "nm" "3.42E-05" ...
     $ V15 : chr  "OPERATOR:2" "ay3" "nm" "-2.29E-05" ...
     $ V16 : chr  "6" "Name" "<no unit>" "BA_50x_res --- BA_20x_ext --- MU-232_B2-01-a_20x07_LSM_Topo" ...
     $ V17 : chr  "6" "Created on" "<no unit>" "07.07.2020 16:58" ...
     $ V18 : chr  "6" "Studiable type" "<no unit>" "Surface" ...
     $ V19 : chr  "6" "Axis name - X" "<no unit>" "X" ...
     $ V20 : chr  "6" "Axis length - X" "µm" "254.9211018" ...
     $ V21 : chr  "6" "Axis size - X" "points" "1198" ...
     $ V22 : chr  "6" "Axis spacing - X" "µm" "0.212966668" ...
     $ V23 : chr  "6" "Axis name - Y" "<no unit>" "Y" ...
     $ V24 : chr  "6" "Axis length - Y" "µm" "254.9211018" ...
     $ V25 : chr  "6" "Axis size - Y" "points" "1198" ...
     $ V26 : chr  "6" "Axis spacing - Y" "µm" "0.212966668" ...
     $ V27 : chr  "6" "Axis name - Z" "<no unit>" "Z" ...
     $ V28 : chr  "6" "Layer type - Z" "<no unit>" "Topography" ...
     $ V29 : chr  "6" "Axis length - Z" "nm" "249563.8891" ...
     $ V30 : chr  "6" "Axis size - Z" "digits" "65505" ...
     $ V31 : chr  "6" "Axis spacing - Z" "nm" "3.809844884" ...
     $ V32 : chr  "6" "NM-points ratio - Z" "%" "0" ...
     $ V33 : chr  "8" "Name" "<no unit>" "BA_50x_res --- BA_20x_ext --- MU-232-B2-01-a_20x07_LSM_Topo > Leveled (LS-plane)" ...
     $ V34 : chr  "8" "Created on" "<no unit>" "07.07.2020 16:58" ...
     $ V35 : chr  "8" "Studiable type" "<no unit>" "Surface" ...
     $ V36 : chr  "8" "Axis name - X" "<no unit>" "X" ...
     $ V37 : chr  "8" "Axis length - X" "µm" "254.9211018" ...
     $ V38 : chr  "8" "Axis size - X" "points" "1198" ...
     $ V39 : chr  "8" "Axis spacing - X" "µm" "0.212966668" ...
     $ V40 : chr  "8" "Axis name - Y" "<no unit>" "Y" ...
     $ V41 : chr  "8" "Axis length - Y" "µm" "254.9211018" ...
     $ V42 : chr  "8" "Axis size - Y" "points" "1198" ...
     $ V43 : chr  "8" "Axis spacing - Y" "µm" "0.212966668" ...
     $ V44 : chr  "8" "Axis name - Z" "<no unit>" "Z" ...
     $ V45 : chr  "8" "Layer type - Z" "<no unit>" "Topography" ...
     $ V46 : chr  "8" "Axis length - Z" "nm" "270491.3671" ...
     $ V47 : chr  "8" "Axis size - Z" "digits" "70998" ...
     $ V48 : chr  "8" "Axis spacing - Z" "nm" "3.809844884" ...
     $ V49 : chr  "8" "NM-points ratio - Z" "%" "0" ...
     $ V50 : chr  "15" "Name" "<no unit>" "BA_50x_res --- BA_20x_ext --- MU-232-B2-01-a_20x07_LSM_Topo > Leveled (LS-plane) > Form removed (LS-poly 3) > O"| __truncated__ ...
     $ V51 : chr  "15" "Created on" "<no unit>" "07.07.2020 16:58" ...
     $ V52 : chr  "15" "Studiable type" "<no unit>" "Surface" ...
     $ V53 : chr  "15" "Axis name - X" "<no unit>" "X" ...
     $ V54 : chr  "15" "Axis length - X" "µm" "254.9211018" ...
     $ V55 : chr  "15" "Axis size - X" "points" "1198" ...
     $ V56 : chr  "15" "Axis spacing - X" "µm" "0.212966668" ...
     $ V57 : chr  "15" "Axis name - Y" "<no unit>" "Y" ...
     $ V58 : chr  "15" "Axis length - Y" "µm" "254.9211018" ...
     $ V59 : chr  "15" "Axis size - Y" "points" "1198" ...
     $ V60 : chr  "15" "Axis spacing - Y" "µm" "0.212966668" ...
     $ V61 : chr  "15" "Axis name - Z" "<no unit>" "Z" ...
     $ V62 : chr  "15" "Layer type - Z" "<no unit>" "Topography" ...
     $ V63 : chr  "15" "Axis length - Z" "nm" "20482.48807" ...
     $ V64 : chr  "15" "Axis size - Z" "digits" "53762" ...
     $ V65 : chr  "15" "Axis spacing - Z" "nm" "0.380984488" ...
     $ V66 : chr  "15" "NM-points ratio - Z" "%" "0" ...
     $ V67 : chr  "17" "Sq" "nm" "3243.46492" ...
     $ V68 : chr  "17" "Ssk" "<no unit>" "0.063364928" ...
     $ V69 : chr  "17" "Sku" "<no unit>" "3.456648954" ...
     $ V70 : chr  "17" "Sp" "nm" "10477.07343" ...
     $ V71 : chr  "17" "Sv" "nm" "10005.41463" ...
     $ V72 : chr  "17" "Sz" "nm" "20482.48807" ...
     $ V73 : chr  "17" "Sa" "nm" "2505.545764" ...
     $ V74 : chr  "17" "Smr (c = 1000 nm below highest peak)" "%" "0.551009273" ...
     $ V75 : chr  "17" "Smc (p = 10.00%)" "nm" "3753.565649" ...
     $ V76 : chr  "17" "Sxp (p = 50.00%  q = 97.50%)" "nm" "6582.264251" ...
     $ V77 : chr  "17" "Sal (s = 0.2000)" "µm" "25.94647646" ...
     $ V78 : chr  "17" "Str (s = 0.2000)" "<no unit>" "0.321132254" ...
     $ V79 : chr  "17" "Std (Reference angle = 0.000°)" "°" "42.49526812" ...
     $ V80 : chr  "17" "Sdq" "<no unit>" "0.602524437" ...
     $ V81 : chr  "17" "Sdr" "%" "9.99401306" ...
     $ V82 : chr  "17" "Vm (p = 10.00%)" "µm³/µm²" "0.209379149" ...
     $ V83 : chr  "17" "Vv (p = 10.00%)" "µm³/µm²" "3.962846805" ...
     $ V84 : chr  "17" "Vmp (p = 10.00%)" "µm³/µm²" "0.209379149" ...
     $ V85 : chr  "17" "Vmc (p = 10.00%  q = 80.00%)" "µm³/µm²" "2.775219749" ...
     $ V86 : chr  "17" "Vvc (p = 10.00%  q = 80.00%)" "µm³/µm²" "3.55940934" ...
     $ V87 : chr  "17" "Vvv (p = 80.00%)" "µm³/µm²" "0.403437465" ...
     $ V88 : chr  "18" "Maximum depth of furrows" "nm" "12698.49874" ...
     $ V89 : chr  "18" "Mean depth of furrows" "nm" "2585.970205" ...
     $ V90 : chr  "18" "Mean density of furrows" "cm/cm2" "2987.422098" ...
     $ V91 : chr  "19" "First direction" "°" "44.9809005" ...
     $ V92 : chr  "19" "Second direction" "°" "26.45485129" ...
     $ V93 : chr  "19" "Third direction" "°" "63.52628654" ...
     $ V94 : chr  "20" "Isotropy" "%" "13.49804216" ...
     $ V95 : chr  "21" "Length-scale anisotropy (Sfrax) (epLsar)" "<no unit>" "0.003682853" ...
     $ V96 : chr  "21" "Length-scale anisotropy (NewEplsar)" "<no unit>" "0.018102172" ...
     $ V97 : chr  "22" "Fractal complexity (Asfc)" "<no unit>" "12.79944237" ...
     $ V98 : chr  "22" "Scale of max complexity (Smfc)" "µm²" "2.508392949" ...
     $ V99 : chr  "22" "HAsfc9 (HAsfc9)" "<no unit>" "0.629247569" ...
      [list output truncated]

## Keep only interesting columns and rows

``` r
# keeps only the columns and rows of interest for the analysis 
data_keep_col <- c(1:2, 16:17, 20:22, 24:26, 29:32, 67:100)
data_keep_rows <- which(merged_data[[1]] != "#")  
data_keep <- merged_data[data_keep_rows, data_keep_col]
```

## Add headers

``` r
head_data_keep <- unlist(merged_data[2, data_keep_col]) 
colnames(data_keep) <- gsub("\\.+", "\\.", make.names(head_data_keep))
colnames(data_keep) <- gsub("\\.$", "", colnames(data_keep)) 
```

## Identify results using frame numbers

``` r
# combines the results from the different analysis based on the column 
# numbers (ID from MountainsMAp)
frames <- as.numeric(unlist(merged_data[1, data_keep_col]))
```

    Warning: NAs durch Umwandlung erzeugt

``` r
ID <- which(frames == 6)[-(1:2)]
ISO <- which(frames == 17)
furrow <- which(frames == 18)
diriso <- which(frames %in% 19:20)
SSFA <- which(frames %in% 21:22)
```

## Shorten the names for parameters

``` r
# keeps only the important information of the headers 
colnames(data_keep)[ISO] <- sapply(strsplit(names(data_keep)[ISO], ".", fixed = TRUE),
                                   `[[`, 1)
colnames(data_keep)[SSFA] <- gsub("^([A-Za-z0-9]+\\.)+", "", colnames(data_keep)[SSFA])
```

## Save units

``` r
# takes the units which were part of the headers and separates them; 
# creates a data frame
var_num <- c(ID, ISO, furrow, diriso, SSFA)
#extract 'unit' line for considered columns
units_var <- unlist(merged_data[3, data_keep_col])[var_num] 
# gets names associated to the units
names(units_var) <- head_data_keep[var_num] 
# puts all of it into a data.frame
units_var_table <- data.frame(variable = names(units_var), unit = units_var) 
```

## Convert to numeric

``` r
for (i in var_num) {
  data_keep[[i]] <- gsub(",", "\\.", data_keep[[i]])
  data_keep[[i]] <- as.numeric(data_keep[[i]])
}
```

## Split the column ‘Name’ into several columns

``` r
# these lines extract the artefact ID out of the path name
stud_name <- gsub("^([A-Za-z0-9_]+( --- ))+", "", data_keep[["Name"]])
stud_name <- gsub("([A-Za-z0-9_-]*( - ))+", "", stud_name)
split_name <- do.call(rbind, strsplit(stud_name, "_"))[, 1:3]
split_loc <- do.call(rbind, strsplit(split_name[, 2], "-"))
# splits location (A1-3,B1-3,C1-3,D1-3) in location (A,B,C,D) and sublocation (1,2,3,4)
split_subloc1 <- substr(split_loc[,1], 1, 1)
split_subloc2 <- substr(split_loc[,1], 2, 2)


# splits the ID in the separat information 
data_final <- data.frame(split_name[, -2], split_subloc1, split_subloc2, 
                         split_loc[, 2-3], data_keep[-3], stringsAsFactors = FALSE)
colnames(data_final)[1:9] <- c("Sample", "Objective", "Location", "Sublocation", 
                               "Area", "Spot", "Analysis.date", "Analysis.time",
                               "Acquisition.date.time")
```

## Format date and time columns

``` r
data_final[["Analysis.date"]] <- as.Date(data_final[["Analysis.date"]],
                                         format = "%d.%m.%Y")
data_final[["Analysis.time"]] <- times(data_final[["Analysis.time"]])
```

The column `data_final[["Acquisition.date.time"]]` includes several
formats and is therefore left as `character` without convertion to
`POSIXct`.

## Add columns with further information and corrects 50x objectives’ NAs

``` r
# extracte the site name based on the ID
data_final[grep("R-0", data_final[["Sample"]]), "Site"] <- "Ramioul"
data_final[grep("MU-", data_final[["Sample"]]), "Site"] <- "Balve"
data_final[grep("BU-", data_final[["Sample"]]), "Site"] <- "Buhlen"
data_final[["Site"]] <- factor(data_final[["Site"]])

# adds the raw material by defining the flint samples, everything else is lydite 
data_final[["Raw.material"]] <- factor(ifelse(data_final[["Sample"]] %in% 
                                                c("MU-224", "MU-197", "R-002", "R-006",
                                                  "R-007", "R-008" ,"R-010" ,"R-013"),
                                                  "flint", "lydite"))

# add the tool type - Keilmesser
data_final[grep("MU-003", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("MU-008", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("MU-020", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("MU-021", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("MU-041", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("MU-107", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("MU-111", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("MU-112", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("MU-199", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("MU-202", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("MU-224", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("MU-232", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("MU-197", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("MU-240", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("MU-246", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("MU-273", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"

data_final[grep("R-002", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("R-006", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("R-007", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("R-008", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("R-020", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"

data_final[grep("BU-003", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("BU-032", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("BU-077", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"
data_final[grep("BU-173", data_final[["Sample"]]), "Tool.type"] <- "Keilmesser"

# add the tool type - Prądnick spall
data_final[grep("MU-104", data_final[["Sample"]]), "Tool.type"] <- "Prądnick spall"
data_final[grep("MU-119", data_final[["Sample"]]), "Tool.type"] <- "Prądnick spall"
data_final[grep("MU-217", data_final[["Sample"]]), "Tool.type"] <- "Prądnick spall"

data_final[grep("BU-128", data_final[["Sample"]]), "Tool.type"] <- "Prądnick spall"

# add the tool type - Scraper 
data_final[grep("MU-019", data_final[["Sample"]]), "Tool.type"] <- "Scraper"
data_final[grep("MU-025", data_final[["Sample"]]), "Tool.type"] <- "Scraper"
data_final[grep("MU-279", data_final[["Sample"]]), "Tool.type"] <- "Scraper"

data_final[grep("R-013", data_final[["Sample"]]), "Tool.type"] <- "Scraper"


# add the tool type - Prądnick scraper 
data_final[grep("R-010", data_final[["Sample"]]), "Tool.type"] <- "Prądnick scraper"
data_final[grep("BU-115", data_final[["Sample"]]), "Tool.type"] <- "Prądnick scraper"
data_final[["Tool.type"]] <- factor(data_final[["Tool.type"]])

# add the use-wear type - Balve 
data_final[data_final[["Sample"]] == "MU-003" & data_final[["Location"]] == "D" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "B"
data_final[data_final[["Sample"]] == "MU-008" & data_final[["Location"]] == "B" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "C"
data_final[data_final[["Sample"]] == "MU-020" & data_final[["Location"]] == "A" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "D"
data_final[data_final[["Sample"]] == "MU-020" & data_final[["Location"]] == "A" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "D2"
data_final[data_final[["Sample"]] == "MU-021" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "3", "Usewear.type"] <- "B"
data_final[data_final[["Sample"]] == "MU-021" & data_final[["Location"]] == "D" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "D2"
data_final[data_final[["Sample"]] == "MU-041" & data_final[["Location"]] == "D" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "E"
data_final[data_final[["Sample"]] == "MU-041" & data_final[["Location"]] == "D" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "E"
data_final[data_final[["Sample"]] == "MU-107" & data_final[["Location"]] == "B" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "C"
data_final[data_final[["Sample"]] == "MU-107" & data_final[["Location"]] == "D" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "C"
data_final[data_final[["Sample"]] == "MU-111" & data_final[["Location"]] == "B" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "E"
data_final[data_final[["Sample"]] == "MU-112" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "E"
data_final[data_final[["Sample"]] == "MU-199" & data_final[["Location"]] == "A" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "E"
data_final[data_final[["Sample"]] == "MU-199" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "3", "Usewear.type"] <- "C"
data_final[data_final[["Sample"]] == "MU-202" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "A"
data_final[data_final[["Sample"]] == "MU-202" & data_final[["Location"]] == "D" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "C"
data_final[data_final[["Sample"]] == "MU-224" & data_final[["Location"]] == "D" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "B2"
data_final[data_final[["Sample"]] == "MU-224" & data_final[["Location"]] == "B" & data_final[["Sublocation"]] == "1", "Usewear.type"] <- "C"
data_final[data_final[["Sample"]] == "MU-232" & data_final[["Location"]] == "B" & data_final[["Sublocation"]] == "2" & data_final[["Area"]] 
           == "01", "Usewear.type"] <- "E"
data_final[data_final[["Sample"]] == "MU-232" & data_final[["Location"]] == "B" &
             data_final[["Sublocation"]] == "2" & data_final[["Area"]] 
           == "02", "Usewear.type"] <- "A"
data_final[data_final[["Sample"]] == "MU-197" & data_final[["Location"]] == "B" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "F"
data_final[data_final[["Sample"]] == "MU-197" & data_final[["Location"]] == "D" &
             data_final[["Sublocation"]] == "3", "Usewear.type"] <- "F"
data_final[data_final[["Sample"]] == "MU-240" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "C+A"
data_final[data_final[["Sample"]] == "MU-240" & data_final[["Location"]] == "D" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "F"
data_final[data_final[["Sample"]] == "MU-246" & data_final[["Location"]] == "D" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "C/E"
data_final[data_final[["Sample"]] == "MU-273" & data_final[["Location"]] == "B" &
             data_final[["Sublocation"]] == "3", "Usewear.type"] <- "C/E"
data_final[data_final[["Sample"]] == "MU-019" & data_final[["Location"]] == "A" &
             data_final[["Sublocation"]] == "3", "Usewear.type"] <- "B2"
data_final[data_final[["Sample"]] == "MU-025" & data_final[["Location"]] == "B" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "B"
data_final[data_final[["Sample"]] == "MU-279" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "C"
data_final[data_final[["Sample"]] == "MU-104" & data_final[["Location"]] == "D" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "C/E"
data_final[data_final[["Sample"]] == "MU-119" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "C"
data_final[data_final[["Sample"]] == "MU-217" & data_final[["Location"]] == "A" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "A"

# add the use-wear type - Ramioul 
data_final[data_final[["Sample"]] == "R-002" & data_final[["Location"]] == "A" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "D"
data_final[data_final[["Sample"]] == "R-006" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "3", "Usewear.type"] <- "E"
data_final[data_final[["Sample"]] == "R-007" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "G"
data_final[data_final[["Sample"]] == "R-008" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "D"
data_final[data_final[["Sample"]] == "R-020" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "A"
data_final[data_final[["Sample"]] == "R-020" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "3", "Usewear.type"] <- "G"
data_final[data_final[["Sample"]] == "R-010" & data_final[["Location"]] == "B" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "C"
data_final[data_final[["Sample"]] == "R-010" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "C/E"
data_final[data_final[["Sample"]] == "R-013" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "G"
data_final[data_final[["Sample"]] == "R-013" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "3", "Usewear.type"] <- "D2"

# add the use-wear type - Buhlen
data_final[data_final[["Sample"]] == "BU-003" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "1", "Usewear.type"] <- "C"
data_final[data_final[["Sample"]] == "BU-032" & data_final[["Location"]] == "B" &
             data_final[["Sublocation"]] == "3", "Usewear.type"] <- "D2"
data_final[data_final[["Sample"]] == "BU-077" & data_final[["Location"]] == "B" &
             data_final[["Sublocation"]] == "3", "Usewear.type"] <- "C/E"
data_final[data_final[["Sample"]] == "BU-173" & data_final[["Location"]] == "C" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "C"
data_final[data_final[["Sample"]] == "BU-128" & data_final[["Location"]] == "D" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "C"
data_final[data_final[["Sample"]] == "BU-115" & data_final[["Location"]] == "A" &
             data_final[["Sublocation"]] == "2", "Usewear.type"] <- "C"
data_final[["Usewear.type"]] <- factor(data_final[["Usewear.type"]])

# correct information about the used objectives 
data_final[data_final[["Objective"]] == "50x09", "Objective"] <- "50x095"
data_final[data_final[["Objective"]] == "50x07", "Objective"] <- "50x075"
data_final[["Objective"]] <- factor(data_final[["Objective"]])
```

## Ignore some columns and reorder columns

``` r
data_final <- data_final[c(1,54, 56, 55, 3:6, 57, 2, 7:53 )]
```

## Add units as comment()

``` r
comment(data_final) <- units_var
```

Type `comment(data_final)` to check the units of the columns.

## Check the result

``` r
str(data_final)
```

    'data.frame':   150 obs. of  57 variables:
     $ Sample                  : chr  "MU-232" "MU-232" "MU-232" "MU-003" ...
     $ Site                    : Factor w/ 3 levels "Balve","Buhlen",..: 1 1 1 1 1 1 1 1 1 1 ...
     $ Tool.type               : Factor w/ 4 levels "Keilmesser","Pradnick scraper",..: 1 1 1 1 1 1 1 1 1 4 ...
     $ Raw.material            : Factor w/ 2 levels "flint","lydite": 2 2 2 2 2 2 2 2 2 2 ...
     $ Location                : chr  "B" "B" "B" "D" ...
     $ Sublocation             : chr  "2" "2" "2" "1" ...
     $ Area                    : chr  "01" "01" "01" "01" ...
     $ Spot                    : chr  "a" "b" "c" "a" ...
     $ Usewear.type            : Factor w/ 11 levels "A","B","B2","C",..: 9 9 9 2 2 2 4 4 4 3 ...
     $ Objective               : Factor w/ 3 levels "20x07","50x075",..: 1 1 1 3 3 3 2 2 2 3 ...
     $ Analysis.date           : Date, format: "2020-09-07" "2020-09-07" ...
     $ Analysis.time           : 'times' num  15:08:03 15:08:27 15:08:51 15:09:16 15:09:41 ...
      ..- attr(*, "format")= chr "h:m:s"
     $ Acquisition.date.time   : chr  "07.07.2020 16:58" "07.08.2020 10:35" "07.08.2020 12:10" "07.03.2020 10:44" ...
     $ Axis.length.X           : num  255 255 255 255 255 ...
     $ Axis.size.X             : num  1198 1198 1198 1198 1198 ...
     $ Axis.spacing.X          : num  0.213 0.213 0.213 0.213 0.213 ...
     $ Axis.length.Y           : num  255 255 255 255 255 ...
     $ Axis.size.Y             : num  1198 1198 1198 1198 1198 ...
     $ Axis.spacing.Y          : num  0.213 0.213 0.213 0.213 0.213 ...
     $ Axis.length.Z           : num  249564 99661 162726 38576 39610 ...
     $ Axis.size.Z             : num  65505 35461 32419 65340 66654 ...
     $ Axis.spacing.Z          : num  3.81 2.81 5.019 0.59 0.594 ...
     $ NM.points.ratio.Z       : num  0 0 0 0 0 0 0 0 0 0 ...
     $ Sq                      : num  3243 2493 4332 1912 1936 ...
     $ Ssk                     : num  0.0634 -0.9445 0.1816 -0.058 -0.2928 ...
     $ Sku                     : num  3.46 7.36 3.08 3.75 3.47 ...
     $ Sp                      : num  10477 7460 12748 6231 5796 ...
     $ Sv                      : num  10005 12962 16115 6843 6575 ...
     $ Sz                      : num  20482 20422 28864 13075 12371 ...
     $ Sa                      : num  2506 1813 3409 1464 1495 ...
     $ Smr                     : num  0.551 0.697 0.388 0.784 0.586 ...
     $ Smc                     : num  3754 2956 5778 2454 2429 ...
     $ Sxp                     : num  6582 4878 7854 3949 4400 ...
     $ Sal                     : num  25.9 20.5 23.4 24.4 24.9 ...
     $ Str                     : num  0.321 0.215 0.241 0.784 0.767 ...
     $ Std                     : num  42.5 93 51 103.7 106.7 ...
     $ Sdq                     : num  0.603 0.376 0.557 0.301 0.298 ...
     $ Sdr                     : num  9.99 5.11 10.54 4.13 4.09 ...
     $ Vm                      : num  0.2094 0.1157 0.2311 0.0944 0.0828 ...
     $ Vv                      : num  3.96 3.07 6.01 2.55 2.51 ...
     $ Vmp                     : num  0.2094 0.1157 0.2311 0.0944 0.0828 ...
     $ Vmc                     : num  2.78 1.82 3.63 1.59 1.6 ...
     $ Vvc                     : num  3.56 2.73 5.53 2.31 2.24 ...
     $ Vvv                     : num  0.403 0.342 0.48 0.238 0.275 ...
     $ Maximum.depth.of.furrows: num  12698 14381 16377 7155 7130 ...
     $ Mean.depth.of.furrows   : num  2586 2471 3670 2350 2229 ...
     $ Mean.density.of.furrows : num  2987 1790 1901 2032 2098 ...
     $ First.direction         : num  44.9809 90.00638 89.98321 0.01527 0.00574 ...
     $ Second.direction        : num  26.5 135 63.5 116.5 135 ...
     $ Third.direction         : num  63.5 116.4 45 135 90 ...
     $ Isotropy                : num  13.5 64.5 14.9 87 86.3 ...
     $ epLsar                  : num  0.00368 0.0024 0.00301 0.00161 0.00236 ...
     $ NewEplsar               : num  0.0181 0.0177 0.0179 0.0171 0.0171 ...
     $ Asfc                    : num  12.8 6.85 12.12 5.51 5.36 ...
     $ Smfc                    : num  2.51 67.38 48.16 94.68 55.32 ...
     $ HAsfc9                  : num  0.629 0.444 0.496 0.666 0.75 ...
     $ HAsfc81                 : num  0.81 2.106 1.515 0.845 0.704 ...
     - attr(*, "comment")= Named chr [1:44] "µm" "points" "µm" "µm" ...
      ..- attr(*, "names")= chr [1:44] "Axis length - X" "Axis size - X" "Axis spacing - X" "Axis length - Y" ...

``` r
head(data_final)
```

``` 
  Sample  Site  Tool.type Raw.material Location Sublocation Area Spot
4 MU-232 Balve Keilmesser       lydite        B           2   01    a
5 MU-232 Balve Keilmesser       lydite        B           2   01    b
6 MU-232 Balve Keilmesser       lydite        B           2   01    c
7 MU-003 Balve Keilmesser       lydite        D           1   01    a
8 MU-003 Balve Keilmesser       lydite        D           1   01    b
9 MU-003 Balve Keilmesser       lydite        D           1   01    c
  Usewear.type Objective Analysis.date Analysis.time Acquisition.date.time
4            E     20x07    2020-09-07      15:08:03      07.07.2020 16:58
5            E     20x07    2020-09-07      15:08:27      07.08.2020 10:35
6            E     20x07    2020-09-07      15:08:51      07.08.2020 12:10
7            B    50x095    2020-09-07      15:09:16      07.03.2020 10:44
8            B    50x095    2020-09-07      15:09:41      07.03.2020 11:12
9            B    50x095    2020-09-07      15:10:06      07.03.2020 11:41
  Axis.length.X Axis.size.X Axis.spacing.X Axis.length.Y Axis.size.Y
4      254.9211        1198      0.2129667      254.9211        1198
5      254.9211        1198      0.2129667      254.9211        1198
6      254.9211        1198      0.2129667      254.9211        1198
7      255.4748        1198      0.2134292      255.4748        1198
8      255.4748        1198      0.2134292      255.4748        1198
9      255.4748        1198      0.2134292      255.4748        1198
  Axis.spacing.Y Axis.length.Z Axis.size.Z Axis.spacing.Z NM.points.ratio.Z
4      0.2129667     249563.89       65505      3.8098449                 0
5      0.2129667      99661.32       35461      2.8104487                 0
6      0.2129667     162726.02       32419      5.0194644                 0
7      0.2134292      38576.34       65340      0.5903939                 0
8      0.2134292      39610.00       66654      0.5942629                 0
9      0.2134292      54863.85       65476      0.8379230                 0
        Sq         Ssk      Sku        Sp        Sv       Sz       Sa       Smr
4 3243.465  0.06336493 3.456649 10477.073 10005.415 20482.49 2505.546 0.5510093
5 2492.686 -0.94453683 7.359355  7460.055 12962.351 20422.41 1813.230 0.6974769
6 4332.029  0.18155179 3.082953 12748.436 16115.492 28863.93 3408.910 0.3877226
7 1911.594 -0.05804613 3.752128  6231.490  6843.079 13074.57 1464.401 0.7842546
8 1935.862 -0.29284833 3.470592  5795.609  6575.044 12370.65 1495.026 0.5859935
9 1413.907 -0.06958621 3.838747  4844.954  5857.249 10702.20 1072.493 0.5892249
       Smc      Sxp      Sal       Str       Std       Sdq       Sdr         Vm
4 3753.566 6582.264 25.94648 0.3211323  42.49527 0.6025244  9.994013 0.20937915
5 2956.412 4877.546 20.48344 0.2150411  93.00821 0.3764870  5.107810 0.11573925
6 5778.475 7853.570 23.40141 0.2410375  50.99436 0.5568364 10.537913 0.23108609
7 2453.748 3948.846 24.43419 0.7836240 103.74504 0.3008461  4.134572 0.09440997
8 2429.328 4399.880 24.92475 0.7667171 106.74682 0.2981428  4.087375 0.08277282
9 1730.839 2853.606 24.16152 0.6924723  93.49320 0.2037989  1.984276 0.08328707
        Vv        Vmp      Vmc      Vvc       Vvv Maximum.depth.of.furrows
4 3.962847 0.20937915 2.775220 3.559409 0.4034375                12698.499
5 3.072057 0.11573925 1.817445 2.730142 0.3419151                14380.925
6 6.009789 0.23108609 3.631368 5.530158 0.4796309                16377.341
7 2.548137 0.09440997 1.586519 2.310376 0.2377615                 7155.043
8 2.512080 0.08277282 1.595735 2.237261 0.2748192                 7129.788
9 1.814126 0.08328707 1.177174 1.626516 0.1876105                 5360.417
  Mean.depth.of.furrows Mean.density.of.furrows First.direction
4              2585.970                2987.422    44.980900500
5              2471.097                1790.038    90.006383440
6              3669.761                1900.754    89.983209400
7              2349.892                2031.595     0.015269467
8              2228.674                2097.686     0.005735854
9              1402.133                2425.201    89.998777760
  Second.direction Third.direction Isotropy      epLsar  NewEplsar      Asfc
4      26.45485129        63.52629 13.49804 0.003682853 0.01810217 12.799442
5     135.00460320       116.44208 64.54651 0.002403307 0.01765029  6.845867
6      63.53048970        44.99152 14.91093 0.003013051 0.01791572 12.117159
7     116.47085940       134.97172 86.95322 0.001612903 0.01709833  5.512847
8     135.02555380        89.99612 86.25183 0.002359666 0.01713881  5.359400
9       0.01726191        45.00826 86.90223 0.000603190 0.01747737  2.502234
       Smfc    HAsfc9   HAsfc81
4  2.508393 0.6292476 0.8101995
5 67.378699 0.4439865 2.1056364
6 48.160760 0.4956623 1.5145332
7 94.675258 0.6660730 0.8450922
8 55.323498 0.7499158 0.7038073
9  7.377919 1.1014543 1.1663644
```

-----

# Save data

## Format name of output file

``` r
file_out <- "Use-wear"
```

The files will be saved as “\~/Use-wear.\[ext\]”.

## Write to XLSX

``` r
write.xlsx(list(data = data_final, units = units_var_table), 
           file = paste0(dir_out, file_out, ".xlsx"))
```

## Save R object

``` r
saveObject(data_final, file = paste0(dir_out, file_out, ".Rbin"))
```

## Show files information

``` r
files_out <- c(paste0(dir_out, file_out, ".xlsx"), paste0(dir_out, file_out, ".Rbin"))
md5_out <- md5sum(files_out)
info_out <- data.frame(files = basename(names(md5_out)), checksum = md5_out, 
                       row.names = NULL)
```

The checksum (MD5 hashes) of the exported files are:

``` 
          files                         checksum
1 Use-wear.xlsx 999a2f7fa06c2cf44859a564d7f86acc
2 Use-wear.Rbin 2b7acbe46dcf8faa0145bc7f141abc26
```

-----

# sessionInfo() and RStudio version

``` r
sessionInfo()
```

``` 
R version 4.0.2 (2020-06-22)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 18362)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.1252    

attached base packages:
[1] tools     stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] forcats_0.5.0     stringr_1.4.0     dplyr_1.0.0       purrr_0.3.4      
 [5] readr_1.3.1       tidyr_1.1.0       tibble_3.0.1      ggplot2_3.3.2    
 [9] tidyverse_1.3.0   chron_2.3-55      R.utils_2.9.2     R.oo_1.23.0      
[13] R.methodsS3_1.8.0 openxlsx_4.1.5   

loaded via a namespace (and not attached):
 [1] tidyselect_1.1.0 xfun_0.15        haven_2.3.1      lattice_0.20-41 
 [5] colorspace_1.4-1 vctrs_0.3.1      generics_0.0.2   htmltools_0.5.0 
 [9] yaml_2.2.1       blob_1.2.1       rlang_0.4.6      pillar_1.4.4    
[13] withr_2.2.0      glue_1.4.1       DBI_1.1.0        dbplyr_1.4.4    
[17] modelr_0.1.8     readxl_1.3.1     lifecycle_0.2.0  munsell_0.5.0   
[21] gtable_0.3.0     cellranger_1.1.0 rvest_0.3.5      zip_2.0.4       
[25] evaluate_0.14    knitr_1.29       fansi_0.4.1      broom_0.5.6     
[29] Rcpp_1.0.4.6     backports_1.1.7  scales_1.1.1     jsonlite_1.7.0  
[33] fs_1.4.2         hms_0.5.3        digest_0.6.25    stringi_1.4.6   
[37] grid_4.0.2       rprojroot_1.3-2  cli_2.0.2        magrittr_1.5    
[41] crayon_1.3.4     pkgconfig_2.0.3  ellipsis_0.3.1   xml2_1.3.2      
[45] reprex_0.3.0     lubridate_1.7.9  rstudioapi_0.11  assertthat_0.2.1
[49] rmarkdown_2.3    httr_1.4.1       R6_2.4.1         nlme_3.1-148    
[53] compiler_4.0.2  
```

RStudio version 1.3.1073.

-----

END OF SCRIPT
